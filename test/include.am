# vim:ft=automake
# included from Top Level Makefile.am
# All paths should be given relative to the root

TEST_EXTENSIONS=.test
# Use a custom test log driver to capture test output to test-suite.log
TEST_LOG_DRIVER = $(top_srcdir)/build-aux/test-driver
AM_TEST_LOG_DRIVER_FLAGS = --preserve-environment
# Ensure test output is captured to test-suite.log
LOG_COMPILER = sh -c 'tee -a test-suite.log'
TESTS += $(check_PROGRAMS)

check_PROGRAMS += test/unit.test
noinst_PROGRAMS += test/unit.test
DISTCLEANFILES += test/.libs/unit.test

# Override the 'certs' directory with the toplevel source directory for 'make distcheck' to work
test_unit_test_CPPFLAGS  = -DCERTS_DIR='"$(abs_top_srcdir)/certs"'
test_unit_test_SOURCES = \
	test/test_aestag.c \
	test/test_cipher.c \
	test/test_cmac.c \
	test/test_dh.c \
	test/test_digest.c \
	test/test_ecc.c \
	test/test_gmac.c \
	test/test_hkdf.c \
	test/test_hmac.c \
	test/test_logging.c \
	test/test_pbe.c \
	test/test_pkey.c \
	test/test_rand.c \
	test/test_rsa.c \
	test/test_tls1_prf.c \
	test/unit.c
test_unit_test_LDADD = libwolfprov.la
noinst_HEADERS += test/unit.h

